server {
    listen 80;
    server_name jr-activity-api.dev.jinr.com;
    index index.html index.htm index.php;
    root  /data/web/jinr_activity_server/public;
    include age-max.conf;
#    include deny_php.conf;

	add_header 'Access-Control-Allow-Origin' '*';
	add_header 'Access-Control-Allow-Credentials' 'true';
	add_header 'Access-Control-Allow-Methods' 'GET,POST,OPTIONS';
        location / {
                        index index.html index.htm index.php;
                              if ( !-e $request_filename){
                                rewrite ^/(.*)$ /index.php?s=$1 last;
                                break;
                                }
                }

    location ~ .*\.php?$
     {
      fastcgi_pass  unix:/tmp/php-cgi56.sock;
      fastcgi_index index.php;
      include fcgi.conf;
     }
    location ~ (.*\.sh?$|/\.)
     {
       return 403;
     }
    access_log  logs/jr-activity.jinr.com.log access;
	error_log   logs/jr-activity.jinr.com.err;
    if ( $fastcgi_script_name ~ \..*\/.*php )
      {
        return 403;
      }
}

server {
    listen 443;
	server_name jr-activity-api.dev.jinr.com;

	include ssl.dev.jinr.conf;

    index index.html index.htm index.php;
    root  /data/web/jinr_activity_server/public;
    include age-max.conf;
    include deny_php.conf;

        location / {
                        index index.html index.htm index.php;
                              if ( !-e $request_filename){
                                rewrite ^/(.*)$ /index.php?s=$1 last;
                                break;
                                }
                }

    location ~ .*\.php?$
     {
      fastcgi_pass  unix:/tmp/php-cgi56.sock;
      fastcgi_index index.php;
      include fcgi.conf;
     }
    location ~ (.*\.sh?$|/\.)
     {
       return 403;
     }
    access_log  logs/jinrapp.pre.jinr.com.log access;
    error_log   logs/jinrapp.pre.jinr.com.err;
    if ( $fastcgi_script_name ~ \..*\/.*php )
      {
        return 403;
      }
}

